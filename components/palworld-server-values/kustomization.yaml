apiVersion: kustomize.config.k8s.io/v1alpha1
kind: Component

configMapGenerator:
- name: palworld-server-values
  namespace: palworld
  literals:
  # Basic server settings
  - TZ=America/New_York
  - PLAYERS="4"
  - PORT="8211"
  - QUERY_PORT="27015"
  - REST_API_PORT="8212"
  - PUID="1000"
  - PGID="1000"
  - MULTITHREADING="false"
  - COMMUNITY="false"
  - PUBLIC_IP=""
  - PUBLIC_PORT=""
  # Server info
  - SERVER_NAME=Lost in the woods
  - SERVER_DESCRIPTION=""
  - UPDATE_ON_BOOT="true"
  - RCON_ENABLED="false"
  - RCON_PORT="25575"
  # Backups
  - BACKUP_ENABLED="true"
  - DELETE_OLD_BACKUPS="true"
  - OLD_BACKUP_DAYS="30"
  - BACKUP_CRON_EXPRESSION="0 5 * * 1"
  # Auto update
  - AUTO_UPDATE_ENABLED="false"
  - AUTO_UPDATE_CRON_EXPRESSION="0 * * * *"
  - AUTO_UPDATE_WARN_MINUTES="30"
  # Auto reboot
  - AUTO_REBOOT_ENABLED="false"
  - AUTO_REBOOT_EVEN_IF_PLAYERS_ONLINE="false"
  - AUTO_REBOOT_WARN_MINUTES="5"
  - AUTO_REBOOT_CRON_EXPRESSION="0 0 * * *"
  # Auto pause
  - AUTO_PAUSE_ENABLED="false"
  - AUTO_PAUSE_TIMEOUT_EST="180"
  - AUTO_PAUSE_LOG="true"
  - AUTO_PAUSE_DEBUG="false"
  - ENABLE_PLAYER_LOGGING="true"
  - PLAYER_LOGGING_POLL_PERIOD="5"

patches:
- target:
    kind: StatefulSet
    name: palworld-server
  patch: |
    - op: add
      path: /spec/template/spec/containers/0/envFrom/0
      value:
        configMapRef:
          name: palworld-server-values
