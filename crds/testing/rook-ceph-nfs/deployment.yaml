apiVersion: ceph.rook.io/v1
kind: CephNFS
metadata:
  name: test
spec:
  server:
    active: 1
    logLevel: NIV_DEBUG
  security: {}
---
apiVersion: traefik.io/v1alpha1
kind: IngressRouteTCP
metadata:
  name: rook-ceph-nfs-ingress-tcp
spec:
  entryPoints:
    - nfs
  routes:
    - match: HostSNI(`*`)
      services:
        - name: rook-ceph-nfs-test-a
          port: 2049
          nativeLB: true
      middlewares:
        - name: rook-ceph-nfs-ipallowlist
---
apiVersion: traefik.io/v1alpha1
kind: MiddlewareTCP
metadata:
  name: rook-ceph-nfs-ipallowlist
spec:
  ipAllowList:
    sourceRange:
      - 172.17.0.1/16
      - 10.244.0.1/16
